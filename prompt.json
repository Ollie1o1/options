{
  "goal": "Upgrade the existing Python options screener in the GitHub repository Ollie1o1/options into a more accurate, probability-based options analysis tool.",
  "repo_instructions": {
    "repo_owner": "Ollie1o1",
    "repo_name": "options",
    "branch": "main"
  },
  "tasks": [
    {
      "name": "Add Expected Move Calculation",
      "description": "Implement expected move (EM) using the formula EM = stock_price * IV * sqrt(DTE / 365). Return EM for each contract and integrate it into the scoring model."
    },
    {
      "name": "Break-even Realism Score",
      "description": "Calculate required move = (strike + premium - stock_price). Compare the required move to the expected move. Penalize contracts where required_move > EM. Reward contracts where required_move < 0.5 * EM."
    },
    {
      "name": "Theta Decay Pressure",
      "description": "Compute theta decay pressure (TDP = premium / DTE). Reduce scores for high TDP relative to delta. For DTE <= 7, weight theta more heavily."
    },
    {
      "name": "Catalyst and Momentum Filters",
      "description": "Add price momentum indicators (5-day return, RSI, ATR trend). Add catalyst detection: check upcoming earnings (via yfinance), FDA news for pharma, and major events. Integrate momentum and catalyst scores into the overall rating system."
    },
    {
      "name": "Probability of Profit (PoP)",
      "description": "Estimate probability of profit using delta approximation (PoP â‰ˆ 1 - OTM_Delta). Adjust PoP using expected move boundaries. If strike is outside EM, lower PoP accordingly."
    },
    {
      "name": "Risk Reward Score",
      "description": "Implement risk/reward calculation: RR = max_gain_if_target_hit / premium. Define target_price = stock_price + 0.75 * expected_move. Score RR as: >4 excellent, >3 good, <2 avoid."
    },
    {
      "name": "IV Rank / IV Percentile",
      "description": "Add 30-day and 90-day IV rank/percentile using historical IV (can be pulled from yfinance or volatility APIs). If IV is cheap (lower percentile), favor buying. If IV is expensive, penalize buying calls."
    },
    {
      "name": "Liquidity & Spread Weighting",
      "description": "Improve liquidity scoring using: volume, open interest, bid-ask spread percentage. Add separate modes for day traders (prefer volume + tight spread) and swing traders (prefer higher delta + more DTE)."
    },
    {
      "name": "Composite Quality Score Redesign",
      "description": "Replace current 'quality' score with a weighted composite score combining: PoP, EM realism, RR, momentum, IV rank, liquidity, catalyst strength, and theta pressure. Output final score 0 to 1.0."
    },
    {
      "name": "Code Refactor & Output Improvements",
      "description": "Refactor code into clear modules (data_fetching.py, calc_expected_move.py, scoring.py, filters.py, utils.py). Improve CLI output formatting to display all new metrics with explanations."
    }
  ],
  "constraints": {
    "language": "Python 3",
    "library_preferences": {
      "market_data": "yfinance",
      "math": ["numpy", "math"],
      "analysis_optional": ["ta-lib (if installed)", "pandas_ta fallback"]
    },
    "do_not": [
      "Remove existing functionality unless necessary",
      "Hardcode stock symbols",
      "Add dependencies that require a C compiler"
    ]
  },
  "output_requirements": {
    "format": "Produce updated Python files in the repo with complete implementation.",
    "validation": "After implementing, run the screener on multiple tickers to ensure EM, PoP, RR, IV percentile, momentum, and catalyst values appear correctly.",
    "success_criteria": [
      "Screener outputs realistic probabilities and required moves",
      "Contracts are penalized or rewarded based on expected move and PoP",
      "Liquidity scoring behaves correctly",
      "Final composite score reflects real-world probability of success"
    ]
  }
}